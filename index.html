<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Good Night - 30s Mobile Experience</title>
    <link href="https://fonts.googleapis.com/css2?family=Tiro+Devanagari+Hindi&family=Great+Vibes&display=swap" rel="stylesheet">
    <style>
        /* Mobile Performance Optimization */
        * { -webkit-tap-highlight-color: transparent; outline: none; }
        body { margin: 0; background: #000; overflow: hidden; font-family: 'Tiro Devanagari Hindi', serif; position: fixed; width: 100%; height: 100%; }
        
        #front-page {
            position: absolute; width: 100%; height: 100%;
            background: radial-gradient(circle at center, #1a1a2e 0%, #000000 100%);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 1000; transition: opacity 1.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        /* Starry background effect for front page */
        #front-page::before {
            content: ""; position: absolute; width: 200%; height: 200%;
            background-image: radial-gradient(white, rgba(255,255,255,.2) 2px, transparent 40px);
            background-size: 100px 100px; opacity: 0.3; animation: stars 100s linear infinite;
        }

        @keyframes stars { from { transform: translateY(0); } to { transform: translateY(-50%); } }

        .gn-text {
            font-family: 'Great Vibes', cursive;
            font-size: clamp(60px, 15vw, 90px); color: #fff;
            text-shadow: 0 0 20px #ff4d4d; margin-bottom: 5px; z-index: 2;
        }
        
        .hindi-sub { font-size: clamp(18px, 5vw, 26px); color: #ccc; margin-bottom: 40px; letter-spacing: 2px; z-index: 2; }

        #startBtn {
            background: rgba(255, 255, 255, 0.1); color: white; border: 1.5px solid rgba(255,255,255,0.3);
            padding: 15px 45px; font-size: 18px; cursor: pointer; border-radius: 50px;
            backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            transition: 0.3s; z-index: 2; box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        }
        #startBtn:active { transform: scale(0.92); background: #fff; color: #000; }

        .word-3d { 
            white-space: nowrap; font-weight: bold; pointer-events: none;
            filter: drop-shadow(0 0 10px rgba(255,255,255,0.3));
            will-change: transform, opacity; /* Improves mobile GPU performance */
        }
    </style>
</head>
<body>

<div id="front-page">
    <div class="gn-text">Good Night</div>
    <div class="hindi-sub">शुभ रात्रि — यादों का सफर</div>
    <button id="startBtn">अनुभव शुरू करें</button>
</div>

<script type="importmap">
    {
        "imports": {
            "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
        }
    }
</script>

<script type="module">
    import * as THREE from 'three';
    import { CSS3DRenderer, CSS3DObject } from 'three/addons/renderers/CSS3DRenderer.js';

    const fullText = "तुमने दिल के टुकड़े को और भी छोटे-छोटे टुकड़ों में तोड़ दिया है, लेकिन मैंने हर एक टुकड़े को फिर भी तुमसे जोड़े रखा है। लाख कोशिश कर लो, जान ले लो, मार डालो, जाओ, चल ढूंढो, हम सामने आ जाएंगे, नाम लेकर।";
    const words = fullText.split(' ');
    const totalDuration = 30000; 
    const delayPerWord = totalDuration / words.length;

    let scene, camera, cssRenderer, activeWords = [];
    let isRunning = false;

    function init() {
        scene = new THREE.Scene();
        camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 1, 3000);
        camera.position.z = 1000;

        cssRenderer = new CSS3DRenderer();
        cssRenderer.setSize(window.innerWidth, window.innerHeight);
        cssRenderer.domElement.style.position = 'absolute';
        cssRenderer.domElement.style.top = 0;
        document.body.appendChild(cssRenderer.domElement);

        window.addEventListener('resize', onWindowResize, false);
    }

    function onWindowResize() {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        cssRenderer.setSize(window.innerWidth, window.innerHeight);
    }

    function createWord3D(text, i) {
        const el = document.createElement('div');
        el.className = 'word-3d';
        el.textContent = text;
        
        const colors = ['#ffffff', '#ff6b6b', '#f8c291', '#fffa65', '#ff4d4d'];
        el.style.color = colors[i % colors.length];
        // Smaller font for mobile screens
        const baseSize = window.innerWidth < 600 ? 24 : 36;
        el.style.fontSize = (Math.random() * 8 + baseSize) + 'px';

        const obj = new CSS3DObject(el);
        obj.position.set(0, 0, 0);
        obj.element.style.opacity = "0";
        scene.add(obj);

        return {
            element: obj,
            phi: Math.random() * Math.PI * 2,
            theta: Math.random() * Math.PI,
            distance: 0,
            targetDistance: 400 + Math.random() * 400,
            rotationSpeed: (Math.random() - 0.5) * 0.015
        };
    }

    function startSequence() {
        words.forEach((word, i) => {
            setTimeout(() => {
                if(!isRunning) return;
                const wObj = createWord3D(word, i);
                wObj.element.element.style.transition = "opacity 1.5s ease-out";
                requestAnimationFrame(() => {
                    wObj.element.element.style.opacity = "1";
                });
                activeWords.push(wObj);
            }, i * delayPerWord);
        });
    }

    function animate() {
        if(!isRunning) return;
        requestAnimationFrame(animate);
        
        activeWords.forEach(w => {
            w.distance += (w.targetDistance - w.distance) * 0.007;
            w.element.position.x = w.distance * Math.sin(w.theta) * Math.cos(w.phi);
            w.element.position.y = w.distance * Math.sin(w.theta) * Math.sin(w.phi);
            w.element.position.z = w.distance * Math.cos(w.theta);
            w.element.rotation.z += w.rotationSpeed;
        });

        const time = Date.now() * 0.0002;
        camera.position.x = Math.cos(time) * 100;
        camera.position.y = Math.sin(time) * 100;
        camera.lookAt(0, 0, 0);

        cssRenderer.render(scene, camera);
    }

    document.getElementById('startBtn').addEventListener('click', function() {
        const frontPage = document.getElementById('front-page');
        frontPage.style.opacity = '0';
        
        // Android Audio initialization
        const audio = new Audio('A.mp3'); 
        audio.load();
        audio.play().catch(e => console.log("User interaction required for audio"));

        setTimeout(() => {
            frontPage.style.display = 'none';
            isRunning = true;
            init();
            animate();
            startSequence();
        }, 1200);
    }, { once: true });
</script>
</body>
</html>